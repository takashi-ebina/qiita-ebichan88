---
title: 【DB2】SQLを用いた文字列結合の基本について解説
tags:
  - MySQL
  - SQL
  - db2
private: false
updated_at: '2025-12-28T17:34:29+09:00'
id: 748e709cb874de2d0759
organization_url_name: null
slide: false
ignorePublish: false
---
# はじめに

SELECT文でデータを取得する際に、取得した値を加工して出力したい場合があると思います。

例えば次のようなTABLE（テーブル名：`personal_information`）からデータを取得する際に、

| ID | LASTNAME | ADDRESS | AGE |
| ---- | ---- | ---- | ---- |
| 11111 | 鈴木 | 静岡 | 22 |
| 22222 | 加藤 | 愛知 | 23 |
| 33333 | 佐藤 | 山形 | 36 |
| 44444 | 田中 | 京都 | 26 |

1. `鈴木`, `加藤`ではなく、`鈴木さん`, `加藤さん`と **「さん」付けで出力** する
2. `11111,鈴木,静岡,22`のように**複数のカラムをカンマで結合して１つの文字列として出力**する

という要求を実現する場合、**文字列連結**を用いることになります。

今回はこの文字列連結の方法について以下に解説していきます。

## 実現方法

:::note info
今回はDB2を使用します
:::

### 「さん」付けで出力したい場合

まず「さん」付けで出力する方法について解説します。

今回のように取り出すカラムに文字列を追加したい場合は`CONCAT関数`を使用します。

#### CONCAT関数

`CONCAT関数`は2つの文字列を連結する関数で、次のように使用します。

```SQL:SQL
SELECT CONCAT(LASTNAME,'さん') AS name FROM personal_information
```

このクエリを実行すると次のような結果が表示されます。

```bash:検索結果（イメージ）
name
------------
鈴木さん
加藤さん
佐藤さん
田中さん
```

これで無事、TABLEに存在する苗字に「さん」をつけて取り出すことができます。

### 複数のカラムをカンマで結合して１つの文字列として出力したい場合

複数のカラムをカンマで結合して１つの文字列として出力する方法について説明します。

「さん」付けで出力する方法と同様に文字列連結を用いれば実現できるのですが、DB2のCONCAT関数は**3つ以上の文字列を連結することができません。**

:::note info
MySQLやPostgresqlでは3つ以上の文字列連結が可能です
:::

一応、CONCAT関数を入れ子にする形で記載すれば実行可能ですが、`CONCAT関数`以外で複数の文字列を連結をする場合には`||演算子`を使用します。

#### ||演算子

`||演算子`は複数の文字列を連結することができ、次のように使用します。

```SQL:SQL
SELECT ID || ',' || LASTNAME || ',' || ADDRESS || ',' || AGE AS personal_info FROM personal_information WHERE ID = 11111
```

このクエリを実行すると次のような結果が表示されます。

```bash:検索結果（イメージ）
personal_info
------------
11111,鈴木,静岡,22

```

上記の結果のように、カラムが１つにまとまり、カンマが結合した状態で出力されました。

## 注意点

DB2の`||演算子`は**NULL値を含む文字列を連結すると、結果がNULLになる**という仕様があります。
その場合の対処方法は[こちらの記事](https://qiita.com/ebichan_88/items/e5a7907d6a174de387bc)を参考にしてください。

## 参考サイト

- [イチからはじめる - SQLリファレンス](http://www.i2kt.com/dbms/sqlref/function/character/sql_03020304.html)
